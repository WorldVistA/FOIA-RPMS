<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25" zv="Cache for UNIX (Red Hat Enterprise Linux for x86-64) 2014.1.3 (Build 775)" ts="2018-09-27 12:54:34">
<Class name="AGMPI.Process.AlertProcess">
<Description>
</Description>
<ClassType>persistent</ClassType>
<Super>Ens.BusinessProcessBPL</Super>
<TimeChanged>64244,54447</TimeChanged>
<TimeCreated>61592,35734.428636</TimeCreated>

<XData name="BPL">
<Description>
BPL Definition</Description>
<XMLNamespace>http://www.intersystems.com/bpl</XMLNamespace>
<Data><![CDATA[
<process language='objectscript' request='Ens.AlertRequest' response='Ens.Response' height='2500' width='2000' >
<context>
<property name='AlertItem' type='AGMPI.Alerts.AlertItem' initialexpression='##class(AGMPI.Alerts.AlertItem).%New()' >
</property>
<property name='Delim' type='%String' initialexpression='$c(1)' >
</property>
<property name='Status' type='%Status' initialexpression='$$$OK' >
</property>
</context>
<sequence xend='200' yend='2250' >
<scope name='scope3' xpos='200' ypos='250' xend='200' yend='2150' >
<if name='AlertText' condition='$l(request.AlertText)' xpos='200' ypos='350' xend='200' yend='1700' >
<true>
<assign name="SourceConfigName" property="context.AlertItem.SourceConfigName" value="request.SourceConfigName" action="set" xpos='470' ypos='500' />
<assign name="AlertText" property="context.AlertItem.AlertText" value="$p(request.AlertText,context.Delim)" action="set" xpos='470' ypos='600' />
<assign name="Category" property="context.AlertItem.Category" value="$p(request.AlertText,context.Delim,2)" action="set" xpos='470' ypos='700' />
<if name='No Category' condition='context.AlertItem.Category=""' xpos='470' ypos='800' xend='470' yend='1050' >
<true>
<assign name="Category=&quot;Unknown&quot;" property="context.AlertItem.Category" value="&quot;MPI&quot;" action="set" xpos='605' ypos='950' />
</true>
</if>
<assign name="CreatedTimestamp" property="context.AlertItem.CreatedTimestamp" value="$zdt($h,3,1)" action="set" xpos='470' ypos='1150' />
<assign name="Save AlertItem" property="context.Status" value="context.AlertItem.%Save()" action="set" xpos='470' ypos='1250' />
<if name='Save error' condition='$$$ISERR(context.Status)' xpos='470' ypos='1350' xend='470' yend='1600' >
<true>
<throw name='SaveError' fault='"SaveError"' xpos='605' ypos='1500' />
</true>
</if>
</true>
<false>
<throw name='NoAlertText' fault='"NoAlertText"' xpos='200' ypos='500' />
</false>
</if>
<faulthandlers>
<catch name='NoAlertText' fault='"NoAlertText"' xpos='200' ypos='1800' xend='200' yend='350' >
<trace name='Error in alert process' value='"Error in Alert Process: No text in alert"' xpos='200' ypos='250' />
</catch>
<catch name='SaveError' fault='"SaveError"' xpos='200' ypos='1900' xend='200' yend='350' >
<trace name='Error in alert process' value='"Error in Alert Process: Save error: "_$System.Status.GetErrorCodes(context.Status)_" : "_$System.Status.GetOneStatusText(context.Status)' xpos='200' ypos='250' />
</catch>
<catchall xpos='200' ypos='2000' xend='200' yend='350' >
<trace name='Error in alert process' value='"Error in Alert Process: "_$System.Status.GetErrorCodes(..%Context.%LastError)_" : "_$System.Status.GetOneStatusText(..%Context.%LastError)' xpos='200' ypos='250' />
</catchall>
</faulthandlers>
</scope>
</sequence>
</process>
]]></Data>
</XData>

<Storage name="Default">
<Type>%Library.CacheStorage</Type>
</Storage>
</Class>
</Export>
