CIAVIP24 ;MSC/IND/PLS - EHR v1.1p24 Inits;17-Jul-2018 12:11;PLS
 ;;1.1;VUECENTRIC FRAMEWORK;**24**;23-Oct-2006
 ;;Copyright 2000-2017, Medsphere Systems Corporation
 ;=================================================================
EC ;EP - Environment check
 Q
PRE ;EP - Preinit
 Q
POST ;EP - Postinit
 N VER,FDA,PID,IEN,X,TYPE
 D BMES^XPDUTL("Updating version numbers...")
 F VER=0:1 S X=$P($T(VER+VER),";;",2) Q:'$L(X)  D
 .S PID=$$PRGID^CIAVMCFG($P(X,";"))
 .S:PID FDA(19930.2,PID_",",2)=$P(X,";",2),FDA(19930.2,PID_",",7)=$P(X,";",3)
 D:$D(FDA) FILE^DIE(,"FDA")
 W !!!
 ;Update help file references
 D UPDCHM
 ;Mark menu out of order
 ;Change friendly names of objects
 ;Prompt to enable logins
 I $L($$GETLOGIN^CIAVUTIL),$$ASK^CIAU("Do you want to enable EHR logins","Y") D
 .D SDABORT^CIAVUTIL(,1),BMES^XPDUTL("Application logins have been enabled.")
 Q
 ;Register RPCs to context
REGRPC ;EP-
 I $$REGRPC^CIAURPC("MAGJ USER2","CIAV VUECENTRIC")
 I $$REGRPC^CIAURPC("MAGG CPRS RAD EXAM","CIAV VUECENTRIC")
 I $$REGRPC^CIAURPC("MAG3 CPRS TIU NOTE","CIAV VUECENTRIC")
 Q
 ; Update the friendly name of an existing object
UPDOBJNM(OBJ,NAME) ;EP-
 N PID,FDA
 S PID=$$PRGID^CIAVMCFG(OBJ)
 Q:'PID
 S FDA(19930.2,PID_",",1)=NAME
 D FILE^DIE(,"FDA")
 Q
 ; Attach Event Protocols to Event Types
EVTPRTL(TYPE) ;
 N EVTNM,PRT,EVT,FDA
 S EVTNM="CIAV "_TYPE_" EVENT"
 S EVT=$$EVENTIEN^CIANBEVT(TYPE)
 Q:'EVT
 S PRT=$$FIND1^DIC(101,,,EVTNM)
 Q:'PRT
 S FDA(19941.21,EVT_",",7)=PRT
 D FILE^DIE(,"FDA")
 Q
 ; Delete a USES item
DELUSES(PARENT,ITM) ;EP-
 N PID,ITMIEN,FDA
 S PID=$$PRGID^CIAVMCFG(PARENT)
 I PID D
 .S ITMIEN=$$FIND1^DIC(19930.221,","_PID_",","B",ITM)
 .I ITMIEN D
 ..S FDA(19930.221,ITMIEN_","_PID_",",.01)="@"
 ..D FILE^DIE(,"FDA")
 Q
 ;
UPDCHM ;EP-
 N CHM,PID
 F CHM=0:1 S X=$P($T(CHM+CHM),";;",2) Q:'$L(X)  D
 .S PID=$$PRGID^CIAVMCFG($P(X,";"))
 .D AECHM(PID,$P(X,";",2,99))
 W !!
 Q
 ;
AECHM(PID,VAL) ;EP-
 N LN,FN,IDX,TXT,ARY,CNT,IENS
 S FN=$P(VAL,";"),CNT=0
 S LN=0 F  S LN=$O(^CIAVOBJ(19930.2,PID,6,LN)) Q:'LN  D  Q:$G(IDX)
 .S TXT=^CIAVOBJ(19930.2,PID,6,LN,0)
 .S ARY(LN,0)=TXT,CNT=CNT+1
 .I $$UP^XLFSTR(TXT)[$$UP^XLFSTR($P(VAL,";")) S IDX=LN
 I $G(IDX) D
 .S ^CIAVOBJ(19930.2,PID,6,IDX,0)=VAL
 E  D
 .S ARY($S('CNT:1,1:CNT+1),0)=VAL
 .S IENS=PID_","
 .S FDA(19930.2,IENS,10)="ARY"
 .D FILE^DIE(,"FDA")
 Q
 ; Rename .01 field of BEH Measurement file
BEHMSR(X,Y) ;
 N IEN,FDA
 S IEN=$O(^BEHOVM(90460.01,"B",X,0))
 Q:'IEN
 S FDA(90460.01,IEN_",",.01)=Y
 D FILE^DIE(,"FDA")
 Q
VER ;;VCQUICKNOTE.QUICKNOTE;1.1.5.1;B3285366509F37B67A1D2833982E429F
 ;;BEHESIGSERVICE.ESIGSERVICE;20.1.4.3;A34E3256DCE01BD331F2C2B55488F8E1
 ;;BEHQOWIZARD.QOWIZARD;1.1.5.3;84874AE6E12E7810C950F3EECA54F3A4
 ;;VCPRINT.VCPRINTX;1.1.5.2;E28539E40DA37606D29ECC794C7591D1
 ;;CSS_PATIENT.PATIENT;4.3.6.1;D0290CA854FF4D98E9DC518A913D6A51
 ;;BEHSPELLCHECK.SPELLCHECK;1.0.3.0;6A7F80FCBEDE3643485B68C5CBD3ADED
 ;;FILE:INDIANHEALTHSERVICE.SNOMEDCTSEARCH.DLL;1.0.9.0;1BAEFA17A8A10705D2EE0CEC3B53D9FD
 ;;BEHMEDLIST.MEDLIST;4.2.4.5;272DF6CDCD6201BA53BED3CD2BB1A1CB
 ;;BEHALLERGIES.ALLERGIES;4.2.6.0;4C81B707A5E140D6B7AA955E8A2D90A7
 ;;IHSBGOEYEEXAM.BGOEYEEXAM;1.1.0.17;A98CCF3A72562D0D37915291CACBC4B1
 ;;BEHDIRECT.MAILBUTTON;1.1.6746.27509;6D2B164EB6D6B3AE2A35EAB2C42138DB
 ;;BEHVITALENTRY.VITALENTRY;2.0.8.8;6995BB7B6E2A9937AF2B029CF17308FF
 ;;BEHVITALENTRY.VITALENTRY2;2.0.8.8;6995BB7B6E2A9937AF2B029CF17308FF
 ;;
CHM ;;
 ;;
